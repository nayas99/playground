<!DOCTYPE html>
<html>
<head>
    <title>Membership Details</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { color: #333; }
        select, table, button { margin-top: 15px; }
        table { border-collapse: collapse; width: 100%; margin-top: 15px; }
        th, td { border: 1px solid #ccc; padding: 8px; }
        th { background-color: #f4f4f4; }
        input, select { width: 100%; }
    </style>
</head>
<body>

<h1>Membership Details</h1>

<label for="yearSelect">Select Year:</label>
<select id="yearSelect">
    <option value="">-- Select Year --</option>
    <option value="2023">2023</option>
    <option value="2024">2024</option>
    <option value="2025">2025</option>
</select>

<table id="membershipTable" style="display:none;">
    <thead>
        <tr>
            <th>Name</th>
            <th>Date</th>
            <th>Paid</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<button id="saveBtn" style="display:none;">Save Changes</button>

<script>
    const API_URL = "PASTE_YOUR_WEB_APP_URL_HERE";

    let currentData = [];

    document.getElementById("yearSelect").addEventListener("change", function() {
        const year = this.value;
        if (year) {
            fetch(`${API_URL}?year=${year}`)
                .then(res => res.json())
                .then(data => {
                    currentData = data;
                    renderTable(data);
                });
        } else {
            document.getElementById("membershipTable").style.display = "none";
            document.getElementById("saveBtn").style.display = "none";
        }
    });

    function renderTable(data) {
        const tbody = document.querySelector("#membershipTable tbody");
        tbody.innerHTML = "";

        data.forEach((entry, index) => {
            const row = `<tr>
                <td>${entry.name}</td>
                <td><input type="date" value="${entry.date}"></td>
                <td>
                    <select>
                        <option value="Yes" ${entry.paid === "Yes" ? "selected" : ""}>Yes</option>
                        <option value="No" ${entry.paid === "No" ? "selected" : ""}>No</option>
                    </select>
                </td>
            </tr>`;
            tbody.innerHTML += row;
        });

        document.getElementById("membershipTable").style.display = "table";
        document.getElementById("saveBtn").style.display = "block";
    }

    document.getElementById("saveBtn").addEventListener("click", function() {
        const rows = document.querySelectorAll("#membershipTable tbody tr");
        let updates = [];

        rows.forEach((row, index) => {
            const date = row.querySelector('input').value;
            const paid = row.querySelector('select').value;
            updates.push({
                name: currentData[index].name,
                year: currentData[index].year,
                date: date,
                paid: paid
            });
        });

        fetch(API_URL, {
            method: "POST",
            body: JSON.stringify(updates)
        })
        .then(res => res.json())
        .then(response => {
            alert("Updates saved successfully!");
        });
    });
</script>

</body>
</html>
